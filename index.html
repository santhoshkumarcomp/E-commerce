<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>U-cart</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .fixed-image {
        width: 172px;
        height: 172px;
        object-fit: contain;
      }
      .search-button {
        position: absolute;

        z-index: 1;
        right: 68px;
      }
      i {
        color: #2196f3;
      }
      @media (min-width: 1024px) {
        .search-button {
          right: 387px !important;
        }
      }
      @media (min-width: 1280px) {
        .search-button {
          right: 596px !important;
        }
      }
    </style>
    <script>
      let a;
      let count;
      element = null;

      function search() {
        console.log("in search");
        let str = document.getElementById("txt").value;
        let obj = a;
        let array = new Set();
        for (let i = 0; i < count; i++) {
          text = obj[i]["title"];
          text = text.toLowerCase();
          textDesc = obj[i]["description"];
          textDesc = textDesc.toLowerCase();

          if (
            text.match(new RegExp("\\b" + str + "\\b", "i")) ||
            textDesc.match(new RegExp("\\b" + str + "\\b", "i"))
          ) {
            array.add(i);
          }
        }
        console.log(array);
        if (array.size === 0) {
          console.log("in condition");
          document.getElementById("imageHere").innerHTML = "";
          document.getElementById("imageHere").innerHTML = "No results found";
        } else {
          document.getElementById("imageHere").innerHTML = "";
          for (const value of array) {
            displayCard(value);
          }
        }
      }

      fetch("https://fakestoreapi.com/products")
        .then((res) => res.json())
        .then((json) => {
          console.log(json);
          a = json;
          count = Object.keys(a).length;
          let i = 0;
          let identity = 0;
          loadProducts();
        });

      function loadProducts() {
        document.getElementById("imageHere").innerHTML = "";
        console.log("Loading products...");
        for (let i = 0; i < count; i++) {
          displayCard(i);
        }
      }
      function cardClose() {
        console.log("in card close");
        var element = document.querySelector(".floatcard");
        if (element) {
          console.log("in card closing");
          element.remove();
        }
      }

      function displayCard(i) {
        var card = document.createElement("div");
        card.className =
          " bg-white m-2 h-full w-90 md:w-84 flex md:block md:border solid md:rounded-lg md:shadow-blue-600 md:shadow-md ";

        var elem = document.createElement("img");
        elem.setAttribute("src", a[i]["image"]);
        elem.setAttribute("height", "64");
        elem.setAttribute("width", "64");
        elem.className =
          "relative inline-flex   border-solid border-2 md:left-12 md:text-sm md:mt-2 md:w-43 md:h-43 lg:left-30 lg:block ";

        card.appendChild(elem);
        var title = document.createElement("h1");
        title.innerHTML = "";
        title.className = " w-52 md:w-40 block md-inline-block ";
        title.innerHTML = a[i]["title"];
        var anchor = document.createElement("button");
        anchor.onclick = () => detailedView(i);
        anchor.className = "text-gray-500";
        anchor.appendChild(title);
        card.appendChild(anchor);
        var col = document.createElement("div");
        col.className = "inline-block";
        var price = document.createElement("h4");
        price.innerHTML = "";
        price.className = "block text-green-700 mt-2 ml-2";
        price.innerHTML = " ₹. " + a[i]["price"];
        col.appendChild(price);
        var rating = document.createElement("h5");
        rating.innerHTML = "";
        rating.className = "block text-violet-600 mt-2   ml-2";
        rating.innerHTML = "Rating: " + a[i]["rating"].rate;
        col.appendChild(rating);
        card.appendChild(col);
        document.getElementById("imageHere").appendChild(card);
      }

      function detailedView(i) {
        cardClose();
        var floatingcard = document.createElement("div");
        floatingcard.className =
          "fixed floatcard  top-12 z-20 bg-gray-400 border-solid rounded-lg w-full h-4/6 md:shadow-blue-600 md:shadow-md md:w-4/5 md:h-2/4  lg:h-3/5 xl:h-3/4 bg-opacity-40 backdrop-saturate-180 backdrop-blur-lg ";
        var btn = document.createElement("button");
        btn.innerHTML = "x";
        btn.className = " mx-2 justify-right inline";
        btn.onclick = () => cardClose();
        floatingcard.appendChild(btn);
        element = floatingcard;

        var div1 = document.createElement("div");
        div1.className = "grid gap-1 grid-cols-2 ";
        var elem = document.createElement("img");
        elem.setAttribute("src", a[i]["image"]);
        elem.setAttribute("height", "172");
        elem.setAttribute("width", "172");
        elem.className = "fixed-image fixed  top-4 block mb-4";
        div1.appendChild(elem);

        var title = document.createElement("h1");
        title.innerHTML = "";
        title.className =
          "relative  top-56 md:text-lg bold italic text-center md:absolute md:text-center md:left-32 ";
        title.innerHTML = a[i]["title"];
        div1.appendChild(title);
        floatingcard.appendChild(div1);
        var div2 = document.createElement("div");
        div2.className = "grid gap-1 grid-cols-2";

        var description = document.createElement("p");
        description.innerHTML = "";
        description.className =
          "fixed   overflow-y-auto text-gray-700 top-4 left-44 h-56  text-sm text-justify mr-4 mb-8 ";
        description.innerHTML = a[i]["description"];
        div2.appendChild(description);

        var col = document.createElement("div");
        col.className =
          "relative grid top-72 left-24 gap-4 grid-cols-2 md:left-48  md:top-64 ";
        var price = document.createElement("h4");
        price.innerHTML = "";
        price.className = "text-green-700 font-semibold";
        price.innerHTML = " ₹. " + a[i]["price"];
        col.appendChild(price);
        var rating = document.createElement("h5");
        rating.innerHTML = "";
        rating.className = "text-violet-600";
        rating.innerHTML = "Rating: " + a[i]["rating"].rate;
        col.appendChild(rating);
        div2.appendChild(col);
        floatingcard.appendChild(div2);

        document.getElementById("head").appendChild(floatingcard);
      }

      function showProduct(identity) {
        const myNode = document.getElementById("imageHere");
        while (myNode.firstChild) {
          myNode.removeChild(myNode.lastChild);
        }

        detailedView(identity);

        // Here you can add code to display more information about the product
      }
      function categoryWise(category) {
        document.getElementById("imageHere").innerHTML = "";

        for (let i = 0; i < count; i++) {
          if (a[i].category === category) {
            displayCard(i);
          }
        }
      }
    </script>
  </head>
  <body class="bg-gray-400">
    <header
      id="head"
      class="sticky h-8 z-10 w-full bg-blue-500 text-white flex gap-8 justify-center font-consolas"
    >
      <button class="z-10" onclick="loadProducts()">U-cart</button>

      <div class="z-10">
        <input type="text" class="text-gray-700 mt-1" id="txt" />
        <button
          class="search-button mt-1 md:right-64 lg:absolute lg:right-256 md:absolute"
          onclick="search()"
        >
          <i class="fa-solid fa-magnifying-glass -blue-500"></i>
        </button>
        <button
          class="text-white px-1"
          onclick="categoryWise(`men's clothing`)"
        >
          Men's clothing
        </button>
        <button
          class="text-white px-1"
          onclick="categoryWise(`women's clothing`)"
        >
          Women's clothing
        </button>
        <button class="text-white px-1" onclick="categoryWise(`jewelery`)">
          Jewelery
        </button>
        <button class="text-white px-1" onclick="categoryWise(`electronics`)">
          Electronics
        </button>
      </div>
    </header>
    <!-- <img src="Background.jpeg" alt="BG" class="w-full h-full cover fixed z-0" /> -->
    <!-- // -->
    <div
      id="imageHere"
      class="m -1 h-full w-90 block z-10 md:mt-2 md:flex md:grid md:grid-cols-4 md:gap-2 md:shadow-cyan-500/50 md:m-2"
    ></div>
  </body>
</html>
